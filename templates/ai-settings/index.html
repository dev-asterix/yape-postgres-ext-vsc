<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="{{CSP}}">
    <title>AI Settings</title>
    <style>{{INLINE_STYLES}}</style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-icon">
                <img src="{{LOGO_URI}}" alt="AI">
            </div>
            <h1>AI Configuration</h1>
            <p>Configure AI provider for query assistance and chat features</p>
        </div>

        <div class="card">
            <div id="message" class="message"></div>

            <form id="settingsForm">
                <div class="section-header">
                    <div class="section-icon">ü§ñ</div>
                    <div class="section-title">AI Provider Configuration</div>
                </div>

                <div class="info-box info">
                    <span class="info-box-icon">üí°</span>
                    <div>
                        <strong>About AI Features</strong>
                        The AI assistant helps you write SQL queries, understand database concepts, and optimize your PostgreSQL workflows.
                    </div>
                </div>

                <div class="form-group">
                    <label for="provider">
                        AI Provider
                        <span class="required-indicator">*</span>
                        <span class="label-description">Select which AI service to use</span>
                    </label>
                    <select id="provider" required>
                        <option value="vscode-lm">VS Code Language Model (GitHub Copilot)</option>
                        <option value="openai">OpenAI (GPT-4, GPT-3.5)</option>
                        <option value="anthropic">Anthropic (Claude)</option>
                        <option value="gemini">Google Gemini</option>
                        <option value="custom">Custom Endpoint (OpenAI-compatible)</option>
                    </select>
                </div>

                <!-- VS Code LM Details -->
                <div id="provider-vscode-lm" class="provider-details active">
                    <div class="info-box info">
                        <span class="info-box-icon">‚ÑπÔ∏è</span>
                        <div>
                            <strong>VS Code Language Model</strong>
                            Uses GitHub Copilot or other VS Code language model extensions. No API key required. Make sure you have a compatible LM extension installed.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="model-vscode-lm">
                            Model (Optional)
                            <span class="label-description">
                                <button type="button" class="btn-link list-models-btn" data-provider="vscode-lm">List available models</button>
                            </span>
                        </label>
                        <select id="model-vscode-lm-select" class="hidden">
                            <option value="">Select a model...</option>
                        </select>
                        <input type="text" id="model-vscode-lm" placeholder="Leave empty for default or select from list">
                    </div>
                </div>

                <!-- OpenAI Details -->
                <div id="provider-openai" class="provider-details">
                    <div class="form-group">
                        <label for="apiKey-openai">
                            OpenAI API Key
                            <span class="required-indicator">*</span>
                            <span class="label-description">Get your API key from <a href="https://platform.openai.com/api-keys" class="link" target="_blank">OpenAI Platform</a></span>
                        </label>
                        <input type="password" id="apiKey-openai" placeholder="sk-...">
                    </div>
                    <div class="form-group">
                        <label for="model-openai">
                            Model
                            <span class="label-description">
                                <button type="button" class="btn-link list-models-btn" data-provider="openai">List available models</button>
                            </span>
                        </label>
                        <select id="model-openai-select" class="hidden">
                            <option value="">Select a model...</option>
                        </select>
                        <input type="text" id="model-openai" placeholder="gpt-4 (recommended)">
                    </div>
                </div>

                <!-- Anthropic Details -->
                <div id="provider-anthropic" class="provider-details">
                    <div class="form-group">
                        <label for="apiKey-anthropic">
                            Anthropic API Key
                            <span class="required-indicator">*</span>
                            <span class="label-description">Get your API key from <a href="https://console.anthropic.com/settings/keys" class="link" target="_blank">Anthropic Console</a></span>
                        </label>
                        <input type="password" id="apiKey-anthropic" placeholder="sk-ant-...">
                    </div>
                    <div class="form-group">
                        <label for="model-anthropic">
                            Model
                            <span class="label-description">
                                <button type="button" class="btn-link list-models-btn" data-provider="anthropic">List available models</button>
                            </span>
                        </label>
                        <select id="model-anthropic-select" class="hidden">
                            <option value="">Select a model...</option>
                        </select>
                        <input type="text" id="model-anthropic" placeholder="claude-3-5-sonnet-20241022 (recommended)">
                    </div>
                </div>

                <!-- Gemini Details -->
                <div id="provider-gemini" class="provider-details">
                    <div class="form-group">
                        <label for="apiKey-gemini">
                            Google API Key
                            <span class="required-indicator">*</span>
                            <span class="label-description">Get your API key from <a href="https://makersuite.google.com/app/apikey" class="link" target="_blank">Google AI Studio</a></span>
                        </label>
                        <input type="password" id="apiKey-gemini" placeholder="AIza...">
                    </div>
                    <div class="form-group">
                        <label for="model-gemini">
                            Model
                            <span class="label-description">
                                <button type="button" class="btn-link list-models-btn" data-provider="gemini">List available models</button>
                            </span>
                        </label>
                        <select id="model-gemini-select" class="hidden">
                            <option value="">Select a model...</option>
                        </select>
                        <input type="text" id="model-gemini" placeholder="gemini-pro">
                    </div>
                </div>

                <!-- Custom Endpoint Details -->
                <div id="provider-custom" class="provider-details">
                    <div class="info-box warning">
                        <span class="info-box-icon">‚ö†Ô∏è</span>
                        <div>
                            <strong>Custom Endpoint</strong>
                            Use this for self-hosted or alternative LLM providers that support OpenAI-compatible APIs (like LocalAI, LM Studio, Ollama with proxy, etc.)
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="endpoint-custom">
                            API Endpoint
                            <span class="required-indicator">*</span>
                            <span class="label-description">Full URL to your custom API endpoint</span>
                        </label>
                        <input type="text" id="endpoint-custom" placeholder="http://localhost:8080/v1/chat/completions">
                    </div>
                    <div class="form-group">
                        <label for="apiKey-custom">
                            API Key (Optional)
                            <span class="label-description">Leave empty if not required</span>
                        </label>
                        <input type="password" id="apiKey-custom" placeholder="Optional">
                    </div>
                    <div class="form-group">
                        <label for="model-custom">
                            Model Name
                            <span class="label-description">Model identifier for your custom endpoint</span>
                        </label>
                        <input type="text" id="model-custom" placeholder="custom-model">
                    </div>
                </div>

                <div class="actions">
                    <button type="button" id="testBtn" class="btn-secondary">
                        <span class="btn-icon">‚ö°</span>
                        <span>Test Connection</span>
                    </button>
                    <button type="submit" id="saveBtn" class="btn-primary">
                        <span class="btn-icon">‚úì</span>
                        <span>Save Settings</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script nonce="{{NONCE}}">
        {{INLINE_SCRIPTS}}
    </script>
</body>
</html>
